ScreenManager:
    LoginScreen: 
    MainScreen: 
    ReinscriptionScreen:
    ReinscriptionAddScreen:
    ReinscriptionUpdateScreen:

<LoginScreen>:
    id: login_screen
    name: 'Login'
    MDCard:
        size_hint: None, None
        size: 380, 400
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        elevation:10
        padding: 30
        orientation: 'vertical'
        Image:
            source: "images/logo_science.jpg"
            size_hint_y:None
            width: 100
            allow_stretch: True
            padding_bottom:2
        MDLabel:
            text: "FACULTÉ DES SCIENCES"
            halign: "center"
            font_size: "14px"
        
        MDSpinner:
            id:spinner
            size_hint: None, None
            size: dp(20), dp(20)
            pos_hint: {'center_x': 0.5}
            active:False
        
        MDTextField:
            id: email
            hint_text: "Enter email:"
            pos_hint: {"center_x": 0.5}
            size_hint_x: None
            helper_text_mode:"on_error"
            width:300

        MyMDTextField:
            id: password
            hint_text: "Enter password:"
            pos_hint: {"center_x": 0.5}
            size_hint_x: None
            password: True
            helper_text_mode:"on_error"
            icon_right:"eye-off"
            width:300

        MDLabel:
            text: "Mot de passe oublié"
            halign: "center"
            font_size: "12px"
            
        MDCard:
            size_hint: None, None
            size: 200, 50
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            spacing: 5
            orientation: 'horizontal'
            halign:'center'
            MDRectangleFlatButton:
                text: 'login'
                on_press: root.login()

            MDRectangleFlatButton:
                text: 'auto'
                on_press: root.auto_remplir()


<MainScreen>:
    name:  'Main'
    MDNavigationLayout:
        ScreenManager:
            Screen:
                BoxLayout:
                    orientation:'vertical'
                    MDToolbar:
                        title: 'Menue Principale'
                        left_action_items:[["menu",lambda x: nav_drawer.set_state("toggle")]]
                        right_action_items:[["logout",lambda x: root.logout()]]
                        elevation:5
                    Widget:
                    
        MDNavigationDrawer:
            id:nav_drawer

<ReinscriptionScreen>:
    name: 'Reinscription'

    MDBoxLayout:
        orientation:'vertical'
        size_hint_y:1
        MDBoxLayout:
            orientation:'horizontal'
            size_hint_y:0.5
            size_hint_x:0.3
            MDLabel:
                id:parcours_label
                pos_hint:{"center_y": 0.9}
                size_hint:(0.3,0.15)
            MDTextField:
                id:search
                hint_text:"Recherche"
                pos_hint:{"center_y": 0.9, "center_x":0.2}
                size_hint_x:None
                width:250
                on_text: root.serch_etudiant(search.text)

        MDBoxLayout:
            orientation:'horizontal'
            size_hint_y:0.5
            size_hint_x:0.8
            MDFlatButton:
                id:mention_button
                text:"Mention"
                pos_hint:{"center_y": 0.25}
                on_release:root.menu_mention.open()
            MDLabel:
                id:mention_label
                text:""
                pos_hint:{"center_y": 0.25}
                size_hint_x:1.2

            MDFlatButton:
                id:parcours_button
                text:"Parcours"
                pos_hint:{"center_y": 0.25}
                on_release:root.menu_parcours.open()

            MDLabel:
                id:parcours_label
                text:""
                pos_hint:{"center_y": 0.25}
                size_hint:(0.3,0.15)

            MDFlatButton:
                id:semestre_button
                text:"Semestre"
                pos_hint:{"center_y": 0.25}
                on_release:root.menu_semestre.open()

            MDLabel:
                id:semestre_label
                text:""
                pos_hint:{"center_y": 0.25}
                size_hint:(0.3,0.15)

            MDFlatButton:
                id:annee_button
                text:"Année universitaire"
                pos_hint:{"center_y": 0.25}
                on_release:root.menu_annee_univ.open()

    MDBottomAppBar:
        orientation:'vertical'
        MDToolbar:
            title: 'Réinscription'
            type:'bottom'
            left_action_items:[["keyboard-backspace",lambda x: root.back_main()]]
            elevation:5
            mode:"end"
            icon:"account-plus"
            on_action_button: root.add_new_etudiant()

<ReinscriptionAddScreen>:
    name: 'Reinscription_add'
    MDBoxLayout:
        orientation:'vertical'
        MDToolbar:
            title: 'Ajout etudiant'
            left_action_items:[["keyboard-backspace",lambda x: root.back_home()]]
            elevation:5
        Widget:
        BoxLayout:
            orientation: 'vertical'
            FloatLayout_:
                id: ellipse
                canvas:
                    Color:
                        rgb: 1, 1, 1
                    Ellipse:
                        pos: 80, 430
                        size: 100 , 120
                        angle_start: 0
                        source: self.source
                        angle_end: 360
                MDIconButton:
                    id: camera
                    icon: 'camera'
                    pos: 140, 415
                    on_release: root.file_manager_open()

                MDTextField:
                    id: num_ce
                    hint_text: "Numéro Carte"
                    pos: 70, 370
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:120
                    required: True

                MDIconButton:
                    id:import_etudiant
                    icon: 'account-convert'
                    pos: 190, 370
                    disabled: True if len(num_ce.text) < 4 else False
                    opacity: 0 if len(num_ce.text) < 4 else 1
                    md_bg_color:(0,0,0,0)

                MDTextField:
                    id:mention_field
                    hint_text:"Mention"
                    size_hint_x: None
                    pos: 20, 185
                    width: 250
                    readonly: True
                    on_focus: if self.focus: root.menu_mention.open()


                MDTextField:
                    id:parcours_field
                    hint_text:"Parcours"
                    size_hint_x: None
                    pos: 20, 125
                    width: 180
                    on_focus: if self.focus: root.menu_parcours.open()

                MDTextField:
                    id: nom
                    hint_text: "Nom"
                    pos: 280, 480
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:300
                    required: True

                MDTextField:
                    id: prenom
                    hint_text: "Prénom"
                    pos: 600, 480
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:150
                    required: False

                MDTextField:
                    id: sexe
                    hint_text: "Sexe"
                    pos: 770, 480
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    required: True

                MDTextField:
                    id: date_naiss
                    hint_text: "Né(e) le"
                    pos: 280, 420
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    readonly: True
                    text:""

                MDIconButton:
                    id:calend_naiss
                    icon: 'calendar'
                    pos: 375, 420
                    on_release:root.show_date_picker_naiss()

                MDTextField:
                    id: lieu_naiss
                    hint_text: "à"
                    pos: 440, 420
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:245
                    required: True

                MDTextField:
                    id: nation
                    hint_text: "Nationalité"
                    pos: 725, 420
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:150
                    required: True

                MDTextField:
                    id: addresse
                    hint_text: "Addresse"
                    pos: 280, 360
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:600
                    required: True

                MDTextField:
                    id: num_cin
                    hint_text: "CIN"
                    pos: 280, 300
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:150

                MDTextField:
                    id: date_cin
                    hint_text: "du"
                    pos: 450, 300
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    readonly: True
                    required:True if num_cin.text != "" else False
                    text:""

                MDIconButton:
                    id:calend_cin
                    icon: 'calendar'
                    pos: 540, 300
                    on_release:root.show_date_picker_cin()

                MDTextField:
                    id: lieu_cin
                    hint_text: "à"
                    pos: 600, 300
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:270
                    required: True if num_cin.text != "" else False

                MDTextField:
                    id: num_quintance
                    hint_text: "Quintance"
                    pos: 280, 240
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:260
                    required: True

                MDTextField:
                    id: date_quintance
                    hint_text: "du"
                    pos: 560, 240
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    readonly: True
                    text:""

                MDIconButton:
                    id:calend_quitance
                    icon: 'calendar'
                    pos: 640, 240
                    on_release:root.show_date_picker_quint()

                MDTextField:
                    id: montant
                    hint_text: "Montant"
                    pos: 700, 240
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:180
                    required: True

                MDTextField:
                    id: moyenne
                    hint_text: "Moyenne"
                    pos: 280, 185
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    required: True

                MDTextField:
                    id: etat
                    hint_text: "État"
                    pos: 400, 185
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    required: True

                MDTextField:
                    id: bacc_annee
                    hint_text: "Année bacc"
                    pos: 520, 185
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:90
                    required: True

                MDFillRoundFlatIconButton:
                    id: save_etudiant
                    text: "Sauvegarder"
                    pos: 750, 150
                    width:100
                    disabled: True if (date_naiss.text == "" or date_quintance.text == "" or mention_field.text == "" or parcours_field.text == "" or montant.text == "" or bacc_annee.text == "" or moyenne.text == "" or etat.text =="" or num_quintance.text == "" or addresse.text=="" or nom.text == "" or num_ce.text == "" or nation.text == "" or lieu_naiss.text == "") else False
                    icon: "content-save"
                    on_release:root.enreg_etudiant()
                    md_bg_color:(0,0,0,0)

                MDFillRoundFlatIconButton:
                    id: auto
                    text: "auto"
                    pos: 650, 150
                    on_release:root.auto_complete()
                    width:100

                MDSpinner:
                    id: spinner
                    size_hint: None, None
                    size: dp(50), dp(50)
                    pos: 540, 300
                    active: True

                MDLabel:
                    id:s1
                    text:"S1"
                    pos: 30, 200
                MDCheckbox:
                    id:s1_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.04}

                MDLabel:
                    id:s3
                    text:"S3"
                    pos: 70, 200
                MDCheckbox:
                    id:s3_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.08}

                MDLabel:
                    id:s5
                    text:"S5"
                    pos: 110, 200
                MDCheckbox:
                    id:s5_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.12}

                MDLabel:
                    id:s7
                    text:"S7"
                    pos: 150, 200
                MDCheckbox:
                    id:s7_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.16}

                MDLabel:
                    id:s9
                    text:"S9"
                    pos: 190, 200
                MDCheckbox:
                    id:s9_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.2}


                MDLabel:
                    id:s2
                    text:"S2"
                    pos: 30, 150
                MDCheckbox:
                    id:s2_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.04}

                MDLabel:
                    id:s4
                    text:"S4"
                    pos: 70, 150
                MDCheckbox:
                    id:s4_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.08}

                MDLabel:
                    id:s6
                    text:"S6"
                    pos: 110, 150
                MDCheckbox:
                    id:s6_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.12}

                MDLabel:
                    id:s8
                    text:"S8"
                    pos: 150, 150
                MDCheckbox:
                    id:s8_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.16}

                MDLabel:
                    id:s10
                    text:"S10"
                    pos: 190, 150
                MDCheckbox:
                    id:s10_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.2}

<ReinscriptionUpdateScreen>:
    name: 'Reinscription_update'
    MDBoxLayout:
        orientation:'vertical'
        MDToolbar:
            title: 'Update étudiant'
            left_action_items:[["keyboard-backspace",lambda x: root.back_home()]]
            elevation:5
        Widget:
        BoxLayout:
            orientation: 'vertical'
            FloatLayout_:
                ImageButton:
                    id: ellipse
                    pos: 80, 430
                    size: 100 , 120
                    angle_start: 0
                    size_hint: None, None
                    source:self.source

                MDTextField:
                    id: num_ce
                    hint_text: "Numéro Carte"
                    pos: 70, 370
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:120
                    readonly: True
                    required: True

                MDTextField:
                    id:mention_field
                    hint_text:"Mention"
                    size_hint_x: None
                    pos: 20, 185
                    width: 250
                    readonly: True
                    on_focus: if self.focus: root.menu_mention.open()


                MDTextField:
                    id:parcours_field
                    hint_text:"Parcours"
                    size_hint_x: None
                    pos: 20, 125
                    width: 180
                    on_focus: if self.focus: root.menu_parcours.open()

                MDTextField:
                    id: nom
                    hint_text: "Nom"
                    pos: 280, 480
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:300
                    required: True

                MDTextField:
                    id: prenom
                    hint_text: "Prénom"
                    pos: 600, 480
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:150
                    required: False

                MDTextField:
                    id: sexe
                    hint_text: "Sexe"
                    pos: 770, 480
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    required: True

                MDTextField:
                    id: date_naiss
                    hint_text: "Né(e) le"
                    pos: 280, 420
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    readonly: True
                    text:""

                MDIconButton:
                    id:calend_naiss
                    icon: 'calendar'
                    pos: 375, 420
                    on_release:""

                MDTextField:
                    id: lieu_naiss
                    hint_text: "à"
                    pos: 440, 420
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:245
                    required: True

                MDTextField:
                    id: nation
                    hint_text: "Nationalité"
                    pos: 725, 420
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:150
                    required: True

                MDTextField:
                    id: addresse
                    hint_text: "Addresse"
                    pos: 280, 360
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:600
                    required: True

                MDTextField:
                    id: num_cin
                    hint_text: "CIN"
                    pos: 280, 300
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:150

                MDTextField:
                    id: date_cin
                    hint_text: "du"
                    pos: 450, 300
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    readonly: True
                    text:""

                MDIconButton:
                    id:calend_cin
                    icon: 'calendar'
                    pos: 540, 300
                    on_release:""

                MDTextField:
                    id: lieu_cin
                    hint_text: "à"
                    pos: 600, 300
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:270
                    required: True if num_cin.text != "" else False

                MDTextField:
                    id: num_quintance
                    hint_text: "Quintance"
                    pos: 280, 240
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:260
                    required: True

                MDTextField:
                    id: date_quintance
                    hint_text: "du"
                    pos: 560, 240
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    readonly: True
                    text:""

                MDIconButton:
                    id:calend_quitance
                    icon: 'calendar'
                    pos: 640, 240
                    on_release:""

                MDTextField:
                    id: montant
                    hint_text: "Montant"
                    pos: 700, 240
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:180
                    required: True

                MDTextField:
                    id: moyenne
                    hint_text: "Moyenne"
                    pos: 280, 185
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:100
                    required: True

                MDTextField:
                    id: etat
                    hint_text: "État"
                    pos: 400, 185
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:180
                    required: True

                MDTextField:
                    id: bacc_annee
                    hint_text: "Année bacc"
                    pos: 520, 185
                    size_hint_x: None
                    helper_text_mode:"on_error"
                    width:90
                    required: True

                MDFillRoundFlatIconButton:
                    id: save_etudiant
                    text: "Sauvegarder"
                    pos: 750, 150
                    width:100
                    disabled: True if (mention_field.text == "" or parcours_field.text == "" or montant.text == "" or bacc_annee.text == "" or moyenne.text == "" or etat.text =="" or num_quintance.text == "" or addresse.text=="" or nom.text == "" or num_ce.text == "" or nation.text == "" or lieu_naiss.text == "") else False
                    icon: "content-save"
                    md_bg_color:(0,0,0,0)

                MDSpinner:
                    id: spinner
                    size_hint: None, None
                    size: dp(50), dp(50)
                    pos: 540, 300
                    active: True

                MDLabel:
                    id:s1
                    text:"S1"
                    pos: 30, 200
                MDCheckbox:
                    id:s1_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.04}

                MDLabel:
                    id:s3
                    text:"S3"
                    pos: 70, 200
                MDCheckbox:
                    id:s3_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.08}

                MDLabel:
                    id:s5
                    text:"S5"
                    pos: 110, 200
                MDCheckbox:
                    id:s5_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.12}

                MDLabel:
                    id:s7
                    text:"S7"
                    pos: 150, 200
                MDCheckbox:
                    id:s7_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.16}

                MDLabel:
                    id:s9
                    text:"S9"
                    pos: 190, 200
                MDCheckbox:
                    id:s9_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 1.12,"center_x": 0.2}


                MDLabel:
                    id:s2
                    text:"S2"
                    pos: 30, 150
                MDCheckbox:
                    id:s2_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.04}

                MDLabel:
                    id:s4
                    text:"S4"
                    pos: 70, 150
                MDCheckbox:
                    id:s4_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.08}

                MDLabel:
                    id:s6
                    text:"S6"
                    pos: 110, 150
                MDCheckbox:
                    id:s6_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.12}

                MDLabel:
                    id:s8
                    text:"S8"
                    pos: 150, 150
                MDCheckbox:
                    id:s8_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.16}

                MDLabel:
                    id:s10
                    text:"S10"
                    pos: 190, 150
                MDCheckbox:
                    id:s10_check
                    size: 20,20
                    size_hint:None, None
                    pos_hint: {"center_y": 0.95,"center_x": 0.2}




            